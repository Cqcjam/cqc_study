<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:task="http://www.springframework.org/schema/task"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd     
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd     
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
       http://www.springframework.org/schema/task
	   http://www.springframework.org/schema/task/spring-task-3.0.xsd">

    <!-- 设置使用注解的类所在的jar包 此处主要配置@Controller注解所在的位置 -->
    <!-- 自动扫描且只扫描@Controller -->
    <context:component-scan base-package="com.cqc.*"
        use-default-filters="false">
        <context:include-filter type="annotation"
            expression="org.springframework.stereotype.Controller"/>
    </context:component-scan>

    <!-- <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"
        /> -->

    <bean
        class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="classpath:application.properties"/>
        <property name="ignoreUnresolvablePlaceholders" value="true"></property>
    </bean>
    <!-- 完成请求和注解POJO的映射 -->
    <mvc:annotation-driven/>

    <!-- Default ViewResolver -->
    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass"
            value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/WEB-INF/views/"/>
        <property name="suffix" value=".jsp"></property>
    </bean>

    <bean id="messageSource"
        class="org.springframework.context.support.ResourceBundleMessageSource"
        p:basename="i18n/messages"/>
    <mvc:resources mapping="/resource/**" location="/resource/"/>

    <bean id="multipartResolver"
        class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
        <property name="maxUploadSize">
            <value>2147483648</value>
        </property>
        <property name="maxInMemorySize">
            <value>4096</value>
        </property>
    </bean>

    <!-- 配置拦截器 -->
    <bean id="userInterceptor"
        class="com.interceptor.UserInterceptor">
        <property name="unCheckUrls">
            <list>
                <value>/Unification/login/get-login-url</value>
                <value>/Unification/login/check-signature</value>
                <value>/Unification/login/supplier-login</value>
                <value>/Unification/login/get-user-info</value>
                <value>/Unification/product/lead-in-code</value>
                <value>/Unification/notifyOrder</value>
                <value>/Unification/appFile/download</value>
                <value>/Unification/appFile/upload</value>
                <value>/Unification/freeFlowApp/list</value>
                <value>/Unification/freeFlowApp/detail</value>
                <value>/Unification/freeFlowApp/aaaa</value>
                <value>/Unification/freeFlowApp/bannerList</value>
                <value>/Unification/freeFlowApp/addCount</value>
                <value>/Unification/freeFlowApp/catList</value>
                <value>/Unification/freeFlowApp/search</value>
                <value>/Unification/freeFlowApp/getFreeList</value>
                <value>/Unification/freeFlowApp/manage/list</value>
                <value>/Unification/freeFlowApp/manage/delete</value>
                <value>/Unification/freeFlowApp/manage/update</value>
                <value>/Unification/freeFlowApp/manage/add</value>
                <value>/Unification/freeFlowApp/manage/updateBanner</value>
                <value>/Unification/freeFlowApp/manage/deleteBanner</value>
                <value>/Unification/freeFlowApp/manage/addBanner</value>
                <value>/Unification/freeFlowApp/manage/bannerList</value>
                <value>/Unification/platinumcard/getcode</value>
                <value>/Unification/platinumcard/auth</value>
                <value>/Unification/platinumcard/effect</value>
                <value>/Unification/platinumcard/shareActivity</value>
                <value>/Unification/platinumcard/updateActivityStatus</value>
                <value>/Unification/platinumcard/userinfo</value>
                <value>/Unification/platinumcard/kaola_coupon</value>
                <value>/Unification/platinumcard/openid</value>
                <value>/Unification/platinumcard/coupon</value>
                <value>/Unification/platinumcard/add_coupon</value>
                <value>/Unification/platinumcard/syncOrder</value>
                <value>/Unification/platinumcard/viprecharge</value>
                <value>/Unification/platinumcard/syncHaeOrder</value>
                <value>/Unification/platinumcard/test</value>
                <value>/Unification/platinumcard/hedition</value>
                <value>/Unification/happyEdition/excelExport</value>
                <value>/Unification/platinumcard/idenCode</value>
                <value>/Unification/happyEdition/commitRights</value>

                <value>/Unification/platinumcard/querySelectedList</value>
                <value>/Unification/platinumcard/excelUpload</value>
                <value>/Unification/platinumcard/excelExport</value>
                <value>/Unification/platinumcard/getVerificationCode</value>
                <value>/Unification/platinumcard/recharge</value>
                <value>/Unification/platinumcard/recharge-fail</value>
                <value>/Unification/platinumcard/queryRechargeList</value>
                <value>/Unification/platinumcard/queryExcelList</value>
                <value>/Unification/platinumcard/excelExport</value>

                <value>/Unification/platinumcard/identifyCode</value>
                <value>/Unification/platinumcard/acceptprize</value>
                <value>/Unification/platinumcard/excelUploadWithPize</value>

                <value>/Unification/happyEdition/queryUser</value>
                <value>/Unification/happyEdition/queryRightsLog</value>

                <value>/Unification/secKill/list</value>
                <value>/Unification/secKill/doublePhoneNum</value>
                <value>/Unification/secKill/kill</value>
                <value>/Unification/secKill/bonusBinding</value>
                <value>/Unification/secKill/checkPhone</value>
                <value>/Unification/secKill/phoneBinding</value>
                <value>/Unification/img/valiCode</value>
                <value>/Unification/img/Recharge</value>
                <value>/Unification/secKill/getRestTime</value>
                <value>/Unification/welfare/list</value>
                <value>/Unification/welfare/manage/add</value>
                <value>/Unification/welfare/manage/edit</value>
                <value>/Unification/welfare/manage/delete</value>
                <value>/Unification/welfare/manage/list</value>
                <value>/Unification/page/getItems</value>
                <value>/Unification/page/getDetails</value>
                <value>/Unification/freeFlowUser/edit</value>
                <value>/Unification/freeFlowUser/getUser</value>
                <value>/Unification/freeFlowUser/consumePackage</value>
                <value>/Unification/freeFlowUser/getPackage</value>
                <value>/Unification/freeFlowUser/addFreeAppStart</value>
                <value>/Unification/appVersion/getVersion</value>
                <!-- 白金卡翻翻乐活动 start -->
                <value>/Unification/activity/add</value>
                <value>/Unification/activity/edit</value>
                <value>/Unification/activity/prize/list</value>
                <value>/Unification/activity/select</value>
                <value>/Unification/activity/prize/run</value>
                <value>/Unification/activity/verification/code</value>
                <value>/Unification/activity/submit/info</value>
                <value>/Unification/activity/info</value>
                <value>/Unification/activity/search</value>
                <value>/Unification/activity/status</value>
                <value>/Unification/prize/record/excel/export</value>
                <value>/Unification/prize/record/search</value>
                <!-- end -->
                <!-- 云笔记领取页面 start -->
                <value>/Unification/cloud/note/redeem/code</value>
                <value>/Unification/cloud/note/user/status</value>
                <!-- end -->
            </list>
        </property>
    </bean>
    <bean
        class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">
        <property name="interceptors">
            <list>
                <ref bean="userInterceptor"/>
            </list>
        </property>
        <!-- order越小优先级越高，Springmvc只会取优先级最高的handlerMapping处理请求 -->
        <property name="order" value="-1"/>
    </bean>

    <!-- task任务扫描注解 -->
    <task:annotation-driven/>



    <context:component-scan base-package="com.cqc">
        <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Service"/>
    </context:component-scan>

</beans> 
